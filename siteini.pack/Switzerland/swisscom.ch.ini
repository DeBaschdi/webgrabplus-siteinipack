**------------------------------------------------------------------------------------------------
* @header_start
* WebGrab+Plus ini for grabbing EPG data from TvGuide websites
* @Site: swisscom.ch
* @MinSWversion: V2.1.5
* @Revision 1 - [31/03/2019] DeBaschdi
*  -Creation
* @Remarks: 
* @header_end
**------------------------------------------------------------------------------------------------
site {url=swisscom.ch|timezone=UTC|maxdays=11|cultureinfo=de-DE|charset=UTF-8|titlematchfactor=90}
site {ratingsystem=FSK|episodesystem=xmltv_ns}
*
**url_index{url|http://127.0.0.1/swisscom_ch.php?channel=|channel|&date=##start##0000&time=##time##2359&type=1} **php if u cant update to mono >5.0
url_index{url|https://services.sg1.etvp01.sctv.ch/catalog/tv/channels/list/end=##time##2359;ids=|channel|;level=normal;start=##start##0000} ** if u have mono >5.0
*
urldate.format {datestring|yyyyMMdd}
url_index.headers {customheader=Accept-Encoding=gzip,deflate}
*
scope.range{(urlindex)|end}
index_variable_element.modify {calculate(format=F1)|'config_timespan_days' 1 +}
index_variable_element.modify {calculate(format=timespan,days)}
index_temp_1.modify {calculate(format=date,yyyyMMdd)|'urldate'}
index_temp_2.modify {calculate(format=date,yyyyMMdd)|'urldate' 'index_variable_element' +}
url_index.modify {replace|##start##|'index_temp_1'}
url_index.modify {replace|##time##|'index_temp_2'}
end_scope

*
index_showsplit.scrub {multi(includeblock="AvailabilityStart")|"Content":{"Description":{"Title":|||}
index_showsplit.modify {cleanup(style=jsondecode)}
*
*
index_start.scrub {single|"AvailabilityStart":"||Z"|Z"}
index_stop.scrub {single|"AvailabilityEnd":"||Z"|Z"}

index_title.scrub {single|"||",|",}
index_subtitle.scrub {single|"Subtitle":"||"|"}

index_description.scrub {single|"Summary":"||",|",}
index_description.modify {cleanup}
index_temp_3.scrub {single|"Summary":"|Staffel|:|:}
index_temp_3.modify {addstart(notnull)|Staffel }
index_temp_3.modify {addend(notnull)|:}
index_temp_4.scrub {single|"Summary":"|Episode|:|:}
index_temp_4.modify {addstart(notnull)|Episode }
index_temp_4.modify {addend(notnull)|:}
index_description.modify {remove|'index_temp_3'}
index_description.modify {remove|'index_temp_4'}

index_category.scrub {multi(separator=",")|"Keywords":"||"|"}

index_country.scrub {single |"Country":"||"|"}
index_country.modify {cleanup(style=upper)}

index_showicon.scrub {single|"Poster"|"ContentPath":"|"|}}
index_showicon.modify {addstart(notnull)|https://services.sg1.etvp01.sctv.ch/content/images}
index_showicon.modify {addend(notnull)|_w1920.jpg}

index_temp_5.scrub {single|"Season":||,}
index_temp_5.modify {addstart('index_temp_5' not "")|S}
index_temp_6.scrub {single|"Episode":||,}
index_temp_6.modify {addstart('index_temp_6' not "")|E}
index_episode.modify {set(pattern="S'S1'E'E1'""E'E1'""S'S1'")|'index_temp_5''index_temp_6'}

index_rating.scrub {single|"AgeRestrictionRating":"||+"|+"}

index_starrating.scrub {single|"Rating":"||"|"}
index_starrating.modify {calculate(format=F1)|10 /}
index_starrating.modify {clear("0.0")}
index_starrating.modify {addend(notnull)|/10}
index_starrating.modify {addend(notnull)|(system=IMDb)}

index_actor.scrub {multi (max=5)|"Actor"|"FirstName":"|"}|"}}
index_actor.modify {replace|",|' '}
index_actor.modify {remove|"LastName":"}

index_director.scrub {multi (max=2)|"Director"|"FirstName":"|"}|"}}
index_director.modify {replace|",|' '}
index_director.modify {remove|"LastName":"}

**  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _
**      #####  CHANNEL FILE CREATION (only to create the xxx-channel.xml file)
**
** @auto_xml_channel_start
**url_index {url|http://127.0.0.1/swisscom_ch.php?type=2} **php if u cant update to mono >5.0
*url_index {url|https://services.sg2.etvp01.sctv.ch/portfolio/tv/channels} ** if u have mono >5.0
*index_site_id.scrub {regex||\{"Identifier":"(\d+)",||}
*index_site_channel.scrub {multi|"Title":"||"|"}
** @auto_xml_channel_end

